Table Of Contents:

### 今日工作

1、阅读《计算机视觉 模型、学习和推理》第六章的应用部分，和第七章——复杂数据密度建模的第一节。

2、PyTorch编程训练。

### 计算机视觉应用

第六章结束后根据已有知识，能够建立生成分类模型，书中给出了这个模型的两个应用。


#### 皮肤检测

皮肤检测可以作为人脸分割等算法的基础。

皮肤检测算法的目标是根据某像素的RGB测量值来推测该像素是否是皮肤。

这里对结果进行分析：

![](https://github.com/fantasy995/ComputerVision/blob/main/images/Snipaste_2020-10-22_18-22-24.png?raw=true)

图*a )*是原神图像。

图*b)* 是非皮肤的对数似然函数对原图像像素输入的进行输出的结果。

即*Log(Pr(x|ω=0))* 。可以看出非皮肤部分变亮了。因为像素数据他们符合*ω=0* 。

图*c)* 是皮肤的对数似然函数对原图像像素输入的进行输出的结果。

即*Log(Pr(x|ω=1))* 。可以看出皮肤部分变亮了。因为像素数据他们符合*ω=1* 。

图*d)* 是皮肤的后验概率。

即*Pr(ω|x)* 。  

图*e)* 是对后验概率*Pr(ω|x)>0.5* 阈值化得到*ω* 的估计。

非皮肤像素*x* 输入函数*Pr(ω|x)* 后得到的值预期应该小于0.5，即属于皮肤的概率应该比较小。

让非皮肤部分像素值等于0，因此就显示出了识别到的皮肤图像。

#### 背景差分

*x*  与皮肤检测相同，是某像素点的RGB值。

算法目标是推理图中某个是否是背景*(ω=0)* 或者是否前景目标有遮挡*(ω=1)* 的二值标签。

在训练数据中，背景像素远多于前景目标像素，前景目标外观多变。

因此，选定背景的类条件分布为正态分布：

![](https://github.com/fantasy995/ComputerVision/blob/main/images/Snipaste_2020-10-22_18-56-40.png?raw=true)

选定前景的类条件分布为均匀分布：

![](https://github.com/fantasy995/ComputerVision/blob/main/images/Snipaste_2020-10-22_18-56-54.png?raw=true)

先验选定为伯努利分布。

#### 总结

![](https://github.com/fantasy995/ComputerVision/blob/main/images/Snipaste_2020-10-22_19-06-34.png?raw=true)

### 复杂数据密度建模

前六章的局限性：

1、利用生成模型的分类是基于建立简单的概率模型。

特别是对全局状态的每个值*ω* 都建立关于观察数据*x* 的类条件密度函数*Pr(x|ω=k)* 。

2、假设所有复杂的视觉数据都可以用正太分布来表示。

本章的新内容：

根据基础概率密度函数利用**隐变量**来构建复杂函数。

这章主要是根据人脸检测的示例展开。

#### 书中的人脸检测系统

观察图像中*60\*60* 的RGB图像块，判断它是否包含人脸。在图像中所有可能的子窗口重复该过程。

#### 多元正态分布

首先介绍了根据之前方法，通过类条件密度函数预测的实现。

并且指出该方法的不足：

1、正态分布是单峰的。人脸区域和背景区域的数据分布无法很好用单峰密度函数表示。

2、正态分布不是鲁棒的。（单个异常样本会显著影响均值和方差的估计）

3、多元正态分布参数太多。数据*D = 60 \*60 \* 60 = 10800* 维。多元正态分布的参数——协方差矩阵包含*D(D+1)/2* 个参数。

#### 解决办法

1、使用**混合模型** 使得密度函数*Pr(x|ω)* 多峰。

2、将均匀分布改为***t*分布** 让密度函数鲁棒。

3、处理高维空间中的参数估计，引入**子空间**模型。

![](https://github.com/fantasy995/ComputerVision/blob/main/images/Snipaste_2020-10-22_19-26-38.png?raw=true)